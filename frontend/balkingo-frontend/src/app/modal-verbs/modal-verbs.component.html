<div class="container">
  <!-- WELCOME SCREEN -->
  <div *ngIf="showWelcome" class="welcome active">
    <div class="logo">Balkingo <i class="fas fa-crown"></i></div>
    <h2>Dobrodo≈°li!</h2>
    <p>Pripremite se za uƒçenje modalni glagola na njemaƒçkom jeziku.</p>
    <button class="start-btn" (click)="startCourse()">Zapoƒçni lekciju</button>
  </div>

  <div *ngIf="!showWelcome">
    <div class="logo">
      Balkingo <i class="fas fa-crown"></i>
    </div>

    <!-- Progress bar -->
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="progress"></div>
      </div>
      <p>Napredak: {{ progress }}%</p>
    </div>

    <!-- INTRODUCTION -->
    <div *ngIf="showIntro && currentLesson" class="intro active">
      <h2>Lekcija {{ currentSectionIndex + 1 }}.{{ currentLessonIndex + 1 }}: {{ currentLesson.title }}</h2>
      <p>{{ currentLesson.description }}</p>

      <!-- EXTRA GRAMMAR TABLES FOR MODAL VERBS -->
      <div *ngIf="currentLesson.id === 'modal-muessen'" class="grammar-table">
        <h3>Konjugacija glagola "m√ºssen" (morati)</h3>
        <table>
          <thead>
          <tr><th>Zamjenica</th><th>m√ºssen</th><th>Primjer</th></tr>
          </thead>
          <tbody>
          <tr><td>ich</td><td>muss</td><td>Ich muss lernen.</td></tr>
          <tr><td>du</td><td>musst</td><td>Du musst arbeiten.</td></tr>
          <tr><td>er/sie/es</td><td>muss</td><td>Er muss gehen.</td></tr>
          <tr><td>wir</td><td>m√ºssen</td><td>Wir m√ºssen p√ºnktlich sein.</td></tr>
          <tr><td>ihr</td><td>m√ºsst</td><td>Ihr m√ºsst leise sein.</td></tr>
          <tr><td>sie/Sie</td><td>m√ºssen</td><td>Sie m√ºssen das machen.</td></tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="currentLesson.id === 'modal-wollen'" class="grammar-table">
        <h3>Konjugacija glagola "wollen" (htjeti)</h3>
        <table>
          <thead>
          <tr><th>Zamjenica</th><th>wollen</th><th>Primjer</th></tr>
          </thead>
          <tbody>
          <tr><td>ich</td><td>will</td><td>Ich will essen.</td></tr>
          <tr><td>du</td><td>willst</td><td>Du willst schlafen.</td></tr>
          <tr><td>er/sie/es</td><td>will</td><td>Sie will spielen.</td></tr>
          <tr><td>wir</td><td>wollen</td><td>Wir wollen reisen.</td></tr>
          <tr><td>ihr</td><td>wollt</td><td>Ihr wollt lernen.</td></tr>
          <tr><td>sie/Sie</td><td>wollen</td><td>Sie wollen helfen.</td></tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="currentLesson.id === 'modal-duerfen'" class="grammar-table">
        <h3>Konjugacija glagola "d√ºrfen" (smjeti)</h3>
        <table>
          <thead>
          <tr><th>Zamjenica</th><th>d√ºrfen</th><th>Primjer</th></tr>
          </thead>
          <tbody>
          <tr><td>ich</td><td>darf</td><td>Ich darf gehen.</td></tr>
          <tr><td>du</td><td>darfst</td><td>Du darfst fragen.</td></tr>
          <tr><td>er/sie/es</td><td>darf</td><td>Er darf bleiben.</td></tr>
          <tr><td>wir</td><td>d√ºrfen</td><td>Wir d√ºrfen mitkommen.</td></tr>
          <tr><td>ihr</td><td>d√ºrft</td><td>Ihr d√ºrft mitmachen.</td></tr>
          <tr><td>sie/Sie</td><td>d√ºrfen</td><td>Sie d√ºrfen rauchen.</td></tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="currentLesson.id === 'modal-koennen'" class="grammar-table">
        <h3>Konjugacija glagola "k√∂nnen" (moƒái)</h3>
        <table>
          <thead>
          <tr><th>Zamjenica</th><th>k√∂nnen</th><th>Primjer</th></tr>
          </thead>
          <tbody>
          <tr><td>ich</td><td>kann</td><td>Ich kann schwimmen.</td></tr>
          <tr><td>du</td><td>kannst</td><td>Du kannst singen.</td></tr>
          <tr><td>er/sie/es</td><td>kann</td><td>Er kann lesen.</td></tr>
          <tr><td>wir</td><td>k√∂nnen</td><td>Wir k√∂nnen tanzen.</td></tr>
          <tr><td>ihr</td><td>k√∂nnt</td><td>Ihr k√∂nnt spielen.</td></tr>
          <tr><td>sie/Sie</td><td>k√∂nnen</td><td>Sie k√∂nnen schreiben.</td></tr>
          </tbody>
        </table>
      </div>

      <!-- GO TO QUIZ -->
      <button class="start-btn" (click)="startQuiz()">Idi na kviz</button>
    </div>

    <!-- QUIZ -->
    <div *ngIf="showQuiz && currentLesson" class="quiz active">
      <div class="question">{{ currentLesson.question }}</div>

      <!-- Fun Fact -->
      <div class="fun-fact" *ngIf="currentLesson.funFact">
        <em>üí° Fun Fact: {{ currentLesson.funFact }}</em>
      </div>

      <div
        class="answer"
        *ngFor="let ans of currentLesson.answers"
        (click)="checkAnswer(ans)"
        [class.disabled]="answered"
        [class.correct]="answered && ans === currentLesson.correct"
        [class.incorrect]="answered && ans !== currentLesson.correct && ans === ans"
      >
        {{ ans }}
      </div>

      <div *ngIf="answered" class="result">
        <p>{{ resultMessage }}</p>
        <button class="start-btn" (click)="nextLesson()">Dalje</button>
      </div>
    </div>

    <!-- COMPLETION -->
    <div *ngIf="currentSectionIndex >= sections.length" class="complete active">
      <h2>ƒåestitamo! Zavr≈°ili ste sve lekcije.</h2>
      <p>Sjajan posao! Nastavite vje≈æbati kako biste pobolj≈°ali svoj njemaƒçki.</p>

      <!-- Wrong Answers Summary -->
      <div *ngIf="wrongAnswersList.length > 0" class="wrong-answers">
        <h3>‚ùå Pogre≈°ni odgovori:</h3>
        <ul>
          <li *ngFor="let wrong of wrongAnswersList">
            <strong>Pitanje:</strong> {{ wrong.question }}<br />
            <span style="color: red;"><strong>Tvoj odgovor:</strong> {{ wrong.selected }}</span><br />
            <span style="color: lightgreen;"><strong>Toƒçan odgovor:</strong> {{ wrong.correct }}</span>
          </li>
        </ul>
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button class="start-btn" (click)="restart()">Poƒçni ispoƒçetka</button>
        <button class="start-btn" (click)="goToLection()">Idi na lekcije</button>
      </div>
    </div>
  </div>
</div>
